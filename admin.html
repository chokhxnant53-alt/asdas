<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô | Flash Express</title>
  <link rel="icon" href="https://flashexpress.com/favicon.ico" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: "Prompt", sans-serif; background-color: #fffbea; margin: 0; padding: 0; }
    header { background: #ffeb3b; text-align: center; padding: 18px; font-weight: bold; font-size: 22px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .container { padding: 20px; width: 90%; max-width: 1200px; margin: 25px auto; background: white; border-radius: 12px; box-shadow: 0 3px 6px rgba(0,0,0,0.1); }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: center; font-size: 14px; }
    th { background: #ffeb3b; }
    button { border: none; border-radius: 6px; padding: 7px 12px; cursor: pointer; font-weight: bold; }
    .btn-green { background: #4CAF50; color: white; }
    .btn-red { background: #f44336; color: white; }
  </style>
</head>
<body>

<header>üë®‚Äçüíº ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</header>

<div class="container">
  <table id="customerTable">
    <thead>
      <tr><th>#</th><th>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</th><th>‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô</th><th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-database.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyALSOECmTwrVr0RQAp_b632HmxQQsJvLMw",
  authDomain: "flash-claim-system.firebaseapp.com",
  databaseURL: "https://flash-claim-system-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "flash-claim-system",
  storageBucket: "flash-claim-system.firebasestorage.app",
  messagingSenderId: "369180040049",
  appId: "1:369180040049:web:6753f5e48a23bc6737b4d0",
  measurementId: "G-VLVBYB6Q3Q"
};
const app = firebase.initializeApp(firebaseConfig);
const db = firebase.database();



  const tableBody = document.querySelector("#customerTable tbody");

  // ‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å Firebase ‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå
  const ref = db.ref("customers");
  ref.on("value", (snapshot) => {
    const data = snapshot.val() || {};
    tableBody.innerHTML = "";
    let index = 1;
    Object.keys(data).forEach(phone => {
      const balance = data[phone].balance || 0;
      tableBody.innerHTML += `
        <tr>
          <td>${index++}</td>
          <td>${phone}</td>
          <td>${parseFloat(balance).toLocaleString("th-TH", { minimumFractionDigits: 2 })}</td>
          <td>
            <button class="btn-green" onclick="topUp('${phone}')">‡πÄ‡∏ï‡∏¥‡∏°</button>
            <button class="btn-red" onclick="withdraw('${phone}')">‡∏ñ‡∏≠‡∏ô</button>
          </td>
        </tr>`;
    });
  });

  function topUp(phone) {
    const amount = parseFloat(prompt(`üí∞ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏´‡πâ ${phone}:`));
    if (isNaN(amount) || amount <= 0) return alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
    const ref = db.ref("customers/" + phone + "/balance");
    ref.once("value").then(snap => {
      const current = snap.val() || 0;
      ref.set(current + amount);
      alert(`‚úÖ ‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô ${amount} ‡∏ö‡∏≤‡∏ó‡πÉ‡∏´‡πâ‡πÄ‡∏ö‡∏≠‡∏£‡πå ${phone} ‡πÅ‡∏•‡πâ‡∏ß`);
    });
  }

  function withdraw(phone) {
    const amount = parseFloat(prompt(`üí∏ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏ô‡∏à‡∏≤‡∏Å ${phone}:`));
    if (isNaN(amount) || amount <= 0) return alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
    const ref = db.ref("customers/" + phone + "/balance");
    ref.once("value").then(snap => {
      const current = snap.val() || 0;
      if (current < amount) return alert("‚ùå ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠");
      ref.set(current - amount);
      alert(`üí∏ ‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô ${amount} ‡∏ö‡∏≤‡∏ó‡∏à‡∏≤‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå ${phone} ‡πÅ‡∏•‡πâ‡∏ß`);
    });
  }
</script>
</body>
</html>
